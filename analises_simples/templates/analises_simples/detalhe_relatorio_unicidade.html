<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>{{ titulo }}</title>
    <style>
        body { font-family: sans-serif; line-height: 1.6; margin: 20px; }
        .container { max-width: 900px; margin: auto; }
        h1, h2 { border-bottom: 2px solid #eee; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 0.9em; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f9f9f9; }
        .destaque-ruim { color: #dc3545; font-weight: bold; }
        .destaque-bom { color: #28a745; }
        @media print { .no-print { display: none; } }
    </style>
</head>
<body>
    <div class="container">
        <a href="{% url 'dashboard_analises' %}" class="no-print">&larr; Voltar</a>
        <h1>{{ titulo }}</h1>
        <p>Executado em: {{ relatorio.timestamp_inicio }}</p>

        <h2>Resumo Geral</h2>
        <ul>
            <li><strong>Tabela:</strong> {{ relatorio.tabela_analisada }}</li>
            <li><strong>Total de Registros:</strong> {{ relatorio.total_registros }}</li>
            <li><strong>Média de Unicidade:</strong> {{ relatorio.media_unicidade|floatformat:2 }}%</li>
            <li><strong>Colunas com Problemas:</strong> {{ relatorio.qtd_colunas_com_duplicatas }} de {{ relatorio.total_colunas_analisadas }}</li>
        </ul>

        <h2>Detalhe por Coluna</h2>
        <table>
            <thead>
                <tr>
                    <th>Coluna</th>
                    <th>Preenchidos</th>
                    <th>Únicos</th>
                    <th>Duplicatas</th>
                    <th>Unicidade %</th>
                </tr>
            </thead>
            <tbody>
                {% for col in detalhes_colunas %}
                    <tr>
                        <td><strong>{{ col.nome }}</strong></td>
                        <td>{{ col.preenchidos }}</td>
                        <td>{{ col.unicos }}</td>
                        <td class="{% if col.duplicatas > 0 %}destaque-ruim{% endif %}">{{ col.duplicatas }}</td>
                        <td class="{% if col.percentual == 100 %}destaque-bom{% else %}destaque-ruim{% endif %}">
                            {{ col.percentual|floatformat:2 }}%
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</body>
</html>